#!/usr/bin/env node
if(process.argv.length != 5) {
  getUsage();
}
var mailutil = require('../lib/mailutil');

var subject,receivers,msg;
//console.log('argv size:' + process.argv.length);
//console.log(process.argv);
var valiedParam = 0;
for(var i=2 ; i < process.argv.length ; i++ ) {
  var ctx = process.argv[i].substring(3);
  //console.log('ctx=%s', ctx);
  switch(process.argv[i].substring(0,2)){
    case '-s':
      subject = ctx;
      valiedParam++;
      break;
    case '-r':
      receivers = ctx.split(',');
      valiedParam++;
      break;
    case '-m':
      msg = ctx;
      valiedParam++;
      break;
  }
}

if (valiedParam < 3) {
  getUsage();
}

function getUsage(){
  console.log('[Usage]: nmail "-s=subject" "-r=receivers" "-m=message"');
  process.exit(0);
}
console.log('Will send mail with \n* subject:%s, \n* receivers:%s, \n* mail content:%s', subject, receivers, msg);
mailutil.sendNodeMail(receivers, subject, msg);
